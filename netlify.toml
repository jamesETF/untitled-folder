[build]
command = "bundle install && bundle exec jekyll build"
publish = "_site"
environment = { RUBY_VERSION = "3.2.2" }

[context.production.environment]
RUBY_VERSION = "3.2.2"

[context.deploy-preview.environment]
RUBY_VERSION = "3.2.2"

[context.branch-deploy.environment]
RUBY_VERSION = "3.2.2"

# --- Cache headers for static assets ---
[[headers]]
  for = "/assets/css/*"
  [headers.values]
    Cache-Control = "public, max-age=31536000, immutable"

[[headers]]
  for = "/assets/js/*"
  [headers.values]
    Cache-Control = "public, max-age=31536000, immutable"

[[headers]]
  for = "/uploads/*"
  [headers.values]
    Cache-Control = "public, max-age=2592000"

[[headers]]
  for = "/*.png"
  [headers.values]
    Cache-Control = "public, max-age=2592000"

[[headers]]
  for = "/*.jpg"
  [headers.values]
    Cache-Control = "public, max-age=2592000"

[[headers]]
  for = "/*.jpeg"
  [headers.values]
    Cache-Control = "public, max-age=2592000"

[[headers]]
  for = "/*.webp"
  [headers.values]
    Cache-Control = "public, max-age=2592000"

[[headers]]
  for = "/*.woff2"
  [headers.values]
    Cache-Control = "public, max-age=31536000, immutable"

[[headers]]
  for = "/*.woff"
  [headers.values]
    Cache-Control = "public, max-age=31536000, immutable"

# --- Duplicate URL canonicalization (trailing slash + case fixes) ---
# Source: GSC audit Feb 25, 2026 — all pairs confirmed via impression/click data

# Chicago — case-change rules use force=true; trailing-slash-only cannot use force
# (Netlify matches /path and /path/ as same, causing loops with force=true)
[[redirects]]
  from = "/illinois/chicago"
  to = "/illinois/chicago/"
  status = 301

[[redirects]]
  from = "/Illinois/Chicago"
  to = "/illinois/chicago/"
  status = 301
  force = true

[[redirects]]
  from = "/Illinois/Chicago/"
  to = "/illinois/chicago/"
  status = 301
  force = true

# LA — trailing slash only (no force — Netlify treats /path and /path/ as same)
[[redirects]]
  from = "/California/Los_Angeles"
  to = "/California/Los_Angeles/"
  status = 301

# Boston — lowercase wins (pos 9.4 / 319 clicks vs pos 47.3 / 12 clicks)
# Permalink updated to /massachusetts/boston/ to match winner
[[redirects]]
  from = "/massachusetts/Boston/"
  to = "/massachusetts/boston/"
  status = 301
  force = true

[[redirects]]
  from = "/massachusetts/Boston"
  to = "/massachusetts/boston/"
  status = 301
  force = true

# Raleigh — lowercase wins (pos 44.3 / 7 clicks vs negligible)
[[redirects]]
  from = "/NorthCarolina/Raleigh"
  to = "/northCarolina/raleigh"
  status = 301
  force = true

[[redirects]]
  from = "/NorthCarolina/Raleigh/"
  to = "/northCarolina/raleigh"
  status = 301
  force = true

# About — trailing slash only (no force)
[[redirects]]
  from = "/about-us"
  to = "/about-us/"
  status = 301

# Contact — trailing slash only (no force)
[[redirects]]
  from = "/contact-us"
  to = "/contact-us/"
  status = 301

# Puppy delivery — trailing slash only (no force)
[[redirects]]
  from = "/puppy-delivery"
  to = "/puppy-delivery/"
  status = 301

# Chicago puppies page — duplicate of main puppies page (10K impr but no Chicago-specific queries)
# Consolidate to main puppies page which already ranks for all the same terms
[[redirects]]
  from = "/Illinois/Chicago/french-bulldog-puppies"
  to = "/french-bulldog-puppies/"
  status = 301
  force = true

[[redirects]]
  from = "/Illinois/Chicago/french-bulldog-puppies/"
  to = "/french-bulldog-puppies/"
  status = 301
  force = true

[[redirects]]
  from = "/illinois/chicago/french-bulldog-puppies"
  to = "/french-bulldog-puppies/"
  status = 301
  force = true

[[redirects]]
  from = "/illinois/chicago/french-bulldog-puppies/"
  to = "/french-bulldog-puppies/"
  status = 301
  force = true

# Chicago contact sub-page — no-slash wins (negligible but clean)
[[redirects]]
  from = "/illinois/chicago/contact-us/"
  to = "/illinois/chicago/contact-us"
  status = 301

# --- Thin blog post redirects (GSC data: all under 200 impr, 0-1 clicks/year) ---
# Source: Session 15 analysis, cannibalization data confirmed redirect targets

# Scam post — cannibalizes homepage on branded queries, FAQ has scam section now
[[redirects]]
  from = "/4-signs-of-a-french-bulldog-scam-and-4-ways-you-can-avoid-them-ethical-frenchie"
  to = "/faq/"
  status = 301
  force = true

# Ethics/breeders post — homepage ranks 10x better for every query
[[redirects]]
  from = "/the-ethics-of-where-to-find-a-french-bulldog-puppy-for-your-family/"
  to = "/about-us/"
  status = 301
  force = true

# Also catch the redirect_from that was on the ethics post
[[redirects]]
  from = "/guides/how-to-register-a-blue-french-bulldog-with-the-akc/"
  to = "/about-us/"
  status = 301
  force = true

# Theft post — 1 click/year, pos 23-88 on all queries
[[redirects]]
  from = "/blog/french-bulldog-theft"
  to = "/faq/"
  status = 301
  force = true

# Pricing URLs that were redirect_from on the theft post — reroute to pricing blog
[[redirects]]
  from = "/cheap-french-bulldog-puppies-under-500/"
  to = "/blog/why-french-bulldogs-are-expensive-before-adoption/"
  status = 301
  force = true

[[redirects]]
  from = "/french-bulldog-price/"
  to = "/blog/why-french-bulldogs-are-expensive-before-adoption/"
  status = 301
  force = true

[[redirects]]
  from = "/french-bulldog-price-how-much-does-a-frenchie-cost/"
  to = "/blog/why-french-bulldogs-are-expensive-before-adoption/"
  status = 301
  force = true

# Ohio locations page — no relevance, send to puppies
[[redirects]]
  from = "/locations-blue-jay-ohio-french-bulldog-puppies/"
  to = "/french-bulldog-puppies/"
  status = 301
  force = true

# Health concerns post — cannibalizes health-risks blog post for same queries
[[redirects]]
  from = "/french-bulldogs-health-concerns-care-tips"
  to = "/blog/french-bulldog-health-risks-welfare-problems-behind-the-cute-face/"
  status = 301
  force = true

# Potty training — 5 impressions total, zero queries, non-original content
[[redirects]]
  from = "/potty-train-your-frenchie/"
  to = "/blog/"
  status = 301
  force = true

# --- Duplicate content cluster redirects (Session 21) ---
# Source: GSC audit — ghost pages with 0 impressions consolidated to GSC winners

# Dog food cluster → /blog/best-food-for-french-bulldog (1,582 impr winner)
[[redirects]]
  from = "/the-complete-guide-to-french-bulldog-food/"
  to = "/blog/best-food-for-french-bulldog"
  status = 301
  force = true

[[redirects]]
  from = "/best-french-bulldog-foods/"
  to = "/blog/best-food-for-french-bulldog"
  status = 301
  force = true

[[redirects]]
  from = "/best-dog-food-for-french-bulldogs-with-sensitive-stomach/"
  to = "/blog/best-food-for-french-bulldog"
  status = 301
  force = true

[[redirects]]
  from = "/best-dog-foods-for-french-bulldogs-with-gas/"
  to = "/blog/best-food-for-french-bulldog"
  status = 301
  force = true

[[redirects]]
  from = "/best-dog-foods/french-bulldogs/"
  to = "/blog/best-food-for-french-bulldog"
  status = 301
  force = true

[[redirects]]
  from = "/blog/french-bulldog-care-13-best-dog-food-brands/"
  to = "/blog/best-food-for-french-bulldog"
  status = 301
  force = true

# Blue french bulldog cluster → /puppies/upcoming-colors/blue-french-bulldog (4,582 impr winner)
[[redirects]]
  from = "/blue-french-bulldog/"
  to = "/puppies/upcoming-colors/blue-french-bulldog"
  status = 301
  force = true

[[redirects]]
  from = "/blue-french-bulldog-breed/"
  to = "/puppies/upcoming-colors/blue-french-bulldog"
  status = 301
  force = true

# --- Sold puppy redirects (Section E cleanup, Session 14) ---
# 71 sold puppy pages deleted. 12 Happy Tails featured puppies → /happy-tails/
# All other sold puppies → /french-bulldog-puppies/ (available puppies page)

# Happy Tails featured puppies (12) → social proof page
[[redirects]]
  from = "/french-bulldog-puppies/bean"
  to = "/happy-tails/"
  status = 301
  force = true

[[redirects]]
  from = "/french-bulldog-puppies/rosie"
  to = "/happy-tails/"
  status = 301
  force = true

[[redirects]]
  from = "/french-bulldog-puppies/lucas"
  to = "/happy-tails/"
  status = 301
  force = true

[[redirects]]
  from = "/french-bulldog-puppies/paddington"
  to = "/happy-tails/"
  status = 301
  force = true

[[redirects]]
  from = "/french-bulldog-puppies/brioche"
  to = "/happy-tails/"
  status = 301
  force = true

[[redirects]]
  from = "/french-bulldog-puppies/blue-ivy"
  to = "/happy-tails/"
  status = 301
  force = true

[[redirects]]
  from = "/french-bulldog-puppies/regina"
  to = "/happy-tails/"
  status = 301
  force = true

[[redirects]]
  from = "/french-bulldog-puppies/mona"
  to = "/happy-tails/"
  status = 301
  force = true

[[redirects]]
  from = "/french-bulldog-puppies/polar-bear"
  to = "/happy-tails/"
  status = 301
  force = true

[[redirects]]
  from = "/french-bulldog-puppies/winnie"
  to = "/happy-tails/"
  status = 301
  force = true

[[redirects]]
  from = "/french-bulldog-puppies/daisy-mae"
  to = "/happy-tails/"
  status = 301
  force = true

[[redirects]]
  from = "/french-bulldog-puppies/peanut"
  to = "/happy-tails/"
  status = 301
  force = true

# Remaining sold puppies — /puppies/* catch-all (force=false so available puppies still serve)
[[redirects]]
  from = "/puppies/Allie/"
  to = "/french-bulldog-puppies/"
  status = 301
  force = true

[[redirects]]
  from = "/puppies/ego/"
  to = "/french-bulldog-puppies/"
  status = 301
  force = true

[[redirects]]
  from = "/puppies/roxanne/"
  to = "/french-bulldog-puppies/"
  status = 301
  force = true

[[redirects]]
  from = "/puppies/kona/"
  to = "/french-bulldog-puppies/"
  status = 301
  force = true

[[redirects]]
  from = "/puppies/Black-french-bulldog-puppy-Kona/"
  to = "/french-bulldog-puppies/"
  status = 301
  force = true

# Wildcard catch-all for any remaining /puppies/ sold pages
# force=false ensures currently available puppies (e.g. Kane) still serve their own page
[[redirects]]
  from = "/puppies/*"
  to = "/french-bulldog-puppies/"
  status = 301

# Remaining /french-bulldog-puppies/ sold pages not featured on Happy Tails
# force=false so available puppies (eva, labubu, mila, etc.) still serve
[[redirects]]
  from = "/french-bulldog-puppies/bambi"
  to = "/french-bulldog-puppies/"
  status = 301
  force = true

[[redirects]]
  from = "/french-bulldog-puppies/bentley"
  to = "/french-bulldog-puppies/"
  status = 301
  force = true

[[redirects]]
  from = "/french-bulldog-puppies/bradybunch"
  to = "/french-bulldog-puppies/"
  status = 301
  force = true

[[redirects]]
  from = "/french-bulldog-puppies/bronsonjr"
  to = "/french-bulldog-puppies/"
  status = 301
  force = true

[[redirects]]
  from = "/french-bulldog-puppies/darla"
  to = "/french-bulldog-puppies/"
  status = 301
  force = true

[[redirects]]
  from = "/french-bulldog-puppies/dexter"
  to = "/french-bulldog-puppies/"
  status = 301
  force = true

[[redirects]]
  from = "/french-bulldog-puppies/glacier"
  to = "/french-bulldog-puppies/"
  status = 301
  force = true

[[redirects]]
  from = "/french-bulldog-puppies/grizzly"
  to = "/french-bulldog-puppies/"
  status = 301
  force = true

[[redirects]]
  from = "/french-bulldog-puppies/maple"
  to = "/french-bulldog-puppies/"
  status = 301
  force = true

[[redirects]]
  from = "/french-bulldog-puppies/mario"
  to = "/french-bulldog-puppies/"
  status = 301
  force = true

[[redirects]]
  from = "/french-bulldog-puppies/mira"
  to = "/french-bulldog-puppies/"
  status = 301
  force = true

[[redirects]]
  from = "/french-bulldog-puppies/mrgray"
  to = "/french-bulldog-puppies/"
  status = 301
  force = true

[[redirects]]
  from = "/french-bulldog-puppies/nugget"
  to = "/french-bulldog-puppies/"
  status = 301
  force = true

[[redirects]]
  from = "/french-bulldog-puppies/rocky"
  to = "/french-bulldog-puppies/"
  status = 301
  force = true

[[redirects]]
  from = "/french-bulldog-puppies/aurora"
  to = "/french-bulldog-puppies/"
  status = 301
  force = true

[[redirects]]
  from = "/french-bulldog-puppies/christmas"
  to = "/french-bulldog-puppies/"
  status = 301
  force = true

[[redirects]]
  from = "/french-bulldog-puppies/rhea"
  to = "/french-bulldog-puppies/"
  status = 301
  force = true
